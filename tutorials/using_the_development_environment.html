<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="API Reference" href="../usage/index.html" /><link rel="prev" title="Tutorials" href="index.html" />

    <link rel="shortcut icon" href="../_static/cropped-SBEL-32x32.png"/><meta name="generator" content="sphinx-3.4.2, furo 2020.12.30.beta24"/>
        <title>Using the AV Development Environment - Autonomous Vehicle Toolbox 0.0.33 documentation</title>
      <link rel="stylesheet" href="../_static/styles/furo.css?digest=33d2fc4f3f180ec1ffc6524e273e21d7d58cbe49">
    <link rel="stylesheet" href="../_static/pygments.css">
    <link media="(prefers-color-scheme: dark)" rel="stylesheet" href="../_static/pygments_dark.css">
    


<style>
  :root {
    --color-code-background: #f0f0f0;
  --color-code-foreground: black;
  
  }
  @media (prefers-color-scheme: dark) {
    :root {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }

  /* For allowing end-user-specific overrides */
  .override-light {
    --color-code-background: #f0f0f0;
  --color-code-foreground: black;
  
  }
  .override-dark {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
</style><link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    <link rel="stylesheet" href="../_static/styles/furo-extensions.css?digest=26485485040e7aaf717c13fd0188a5ad2c2deb60">
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script defer="defer" src="../_static/jquery.js"></script>
    <script defer="defer" src="../_static/underscore.js"></script>
    <script defer="defer" src="../_static/doctools.js"></script>
    <script defer src="../_static/scripts/main.js?digest=e931d09b2a40c1bb82b542effe772014573baf67"></script></head>
  <body dir="">
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z"/>
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<div class="announcement">
  <aside class="announcement-content">
     
        <a style="text-decoration: none; color: white;" 
           href="https://sbel.wisc.edu">
           <img src="https://github.com/uwsbel/avtoolbox/blob/master/docs/_static/cropped-SBEL-192x192.png?raw=true" 
                style="vertical-align: middle; display: inline; padding-right: 7.5px; height: 20px;"/>
           Checkout our website!
        </a>
     
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Autonomous Vehicle Toolbox 0.0.33 documentation</div></a>
    </div>
    <div class="header-right">
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/SBEL-light.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/SBEL-dark.png" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html">
  <input class="sidebar-search" placeholder=Search name="q">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup.html">Setup</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Using the AV Development Environment</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../usage/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../usage/cli.html">CLI Documentation</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../usage/api/avtoolbox/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avtoolbox</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../usage/api/avtoolbox/ros/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avtoolbox.ros</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label for="toctree-checkbox-4"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../usage/api/avtoolbox/ros/messages/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avtoolbox.ros.messages</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../usage/api/avtoolbox/utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avtoolbox.utils</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label for="toctree-checkbox-5"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../usage/api/avtoolbox/utils/docker/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avtoolbox.utils.docker</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../usage/api/avtoolbox/utils/files/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avtoolbox.utils.files</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../usage/api/avtoolbox/utils/logger/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avtoolbox.utils.logger</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../usage/api/avtoolbox/utils/yaml_parser/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avtoolbox.utils.yaml_parser</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../usage/api/avtoolbox/db/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avtoolbox.db</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/api/avtoolbox/dev/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avtoolbox.dev</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>
<p><span class="caption-text">External Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/avtoolbox/">PyPI</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/uwsbel/avtoolbox">Github</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <main class="main">
    <div class="content">
      <article role="main">
        <label class="toc-overlay-icon toc-content-icon" for="__toc">
          <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
        </label>
        <section id="using-the-av-development-environment">
<h1>Using the AV Development Environment<a class="headerlink" href="#using-the-av-development-environment" title="Permalink to this headline">¶</a></h1>
<p>The AV development environment has been created to expedite the process from algorithm implementation to testing in simulation to deploying the control stack on the MiniAV (or any other compatible platform).</p>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>You have cloned the <a class="reference external" href="https://github.com/uwsbel/avtoolbox">avtoolbox</a> repository</p></li>
<li><p>You have installed Docker (<a class="reference external" href="https://docs.docker.com/get-docker/">resource for that</a>)</p></li>
<li><p>You have installed docker compose v2 (<a class="reference external" href="https://docs.docker.com/compose/cli-command/">resource for that</a>)</p></li>
<li><p>You have installed <code class="docutils literal notranslate"><span class="pre">avtoolbox</span></code> (<a class="reference external" href="https://projects.sbel.org/avtoolbox/setup.html">resources for that</a>)</p></li>
</ul>
</section>
<section id="design-considerations">
<h2>Design Considerations<a class="headerlink" href="#design-considerations" title="Permalink to this headline">¶</a></h2>
<p>The <em>most</em> important component we considered when creating the development environment was whether the workflow was usable on multiple platforms, i.e. it would work as is on Windows, MacOS, and Linux systems. This was a nonnegotiable because then the MiniAV platform could be developed anywhere and wouldn’t require any special hardware or “hacking” to work on a specific system. Further, the development environment and deployment environment (the system that runs on the actual vehicle) must also be the same or similar in design. This means that any customization to the dependency lists or sensor configurations that was made locally would carry over to the actual vehicle.</p>
<p>Another important element we considered was using simulation to test the control stack. <a class="reference external" href="https://projectchrono.org">Chrono</a> is the simulator of choice and it needed to interface with the development <em>and</em> deployment environment natively. The control stack itself should not be limiting hardware-wise (unless the implemented algorithms require a certain type of CPU, for example), but the Chrono simulations may require specific hardware, such as a NVIDIA GPU. Therefore, the solution must be able to communicate over the network considering everyone may not have access to a NVIDIA GPU on their computer, but a remote server/workstation may.</p>
</section>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<p>To begin, Docker is a tool for virtualizing applications from a main operating system. What this means is that you can run full OS containers within a host OS. The primary purpose behind Docker, and similar tools, is to isolate development environments and to consistently deploy applications across computers. Docker is typically used on servers (think AWS or Azure) to isolate users and to deploy websites and web apps. Docker simply provides the ability to run these isolated containers, it is the users job to create the content that goes inside the containers. For more information on Docker, plesae see their <a class="reference external" href="https://www.docker.com/">official website</a>.</p>
<p>For robotics, containers can be a valuable tool for creating consistent development environments for users with different operating systems or different use cases. For example, a Docker container can be generated that has the entire simulation platform already installed; then, the user can simply run their simulation script in the container without the need to install any dependencies.</p>
<p>To help facilitate complicated scenarios, it is common practice to utilize multiple containers. Think, for instance, with multiple containers, you can have multiple independent systems that can be interchanged easily. Then, each isolated container communicates with the others in some capacity. This is what we will do here, where we have one container for the control stack, another for the simulation, and then other optional containers with other desired features: for example, <code class="docutils literal notranslate"><span class="pre">vnc</span></code> for visualizing gui apps.</p>
<p>There are two <code class="docutils literal notranslate"><span class="pre">services</span></code> (or containers) that will be created: <code class="docutils literal notranslate"><span class="pre">dev</span></code> and <code class="docutils literal notranslate"><span class="pre">vnc</span></code>. <code class="docutils literal notranslate"><span class="pre">dev</span></code> is the ROS 2 development environment we’ll use to write the ROS 2 code. <code class="docutils literal notranslate"><span class="pre">vnc</span></code> is the container used to visualize gui apps. Various attributes are included in the <code class="docutils literal notranslate"><span class="pre">.yml</span></code> file, such as build context, ROS version types, and environment variables. As seen in the <code class="docutils literal notranslate"><span class="pre">volumes</span></code> section under the <code class="docutils literal notranslate"><span class="pre">dev</span></code> service, the entire <code class="docutils literal notranslate"><span class="pre">miniav</span></code> repository will be mounted inside the container. A <a class="reference external" href="https://docs.docker.com/storage/volumes/">volume</a> is simply a folder that is shared between the host OS and the container. This means any and all code additions should be made <em>only</em> inside of this folder; if you edit any files outside of <code class="docutils literal notranslate"><span class="pre">/root/miniav</span></code>, then the changes will not be saved when the container is exited.</p>
</section>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<p>Beyond installing the packages outlined in <a class="reference external" href="#prerequisites">prerequisites</a>, there is not much setup that is necessary. The <code class="docutils literal notranslate"><span class="pre">avtoolbox</span></code> package provides tools for easily spinning up containers and attaching to the development environment within Docker.</p>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>To use the development environment, very convenient commands are provided through the <code class="docutils literal notranslate"><span class="pre">avtoolbox</span></code> CLI. The documentation for the <code class="docutils literal notranslate"><span class="pre">dev</span></code> command can be found <a class="reference external" href="http://projects.sbel.org/avtoolbox/usage/cli.html#dev">here</a>.</p>
<p>As described in the documentation, the <code class="docutils literal notranslate"><span class="pre">dev</span></code> command has four arguments: <code class="docutils literal notranslate"><span class="pre">build</span></code>, <code class="docutils literal notranslate"><span class="pre">up</span></code>, <code class="docutils literal notranslate"><span class="pre">down</span></code>, and <code class="docutils literal notranslate"><span class="pre">attach</span></code>. These may sound familiar if you’ve used <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">compose</span></code> before because the <code class="docutils literal notranslate"><span class="pre">dev</span></code> command essentially wraps <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">compose</span></code>. Everything that the <code class="docutils literal notranslate"><span class="pre">av</span> <span class="pre">dev</span></code> command does, <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">compose</span></code> can also do; the <code class="docutils literal notranslate"><span class="pre">av</span> <span class="pre">dev</span></code> cli command is simply made to expedite the process of entering a container and may also provide an easy mechanism to add additional functionality in the future.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For any commands mentioned herein, it will be assumed they are run from within the <code class="docutils literal notranslate"><span class="pre">av</span></code> repository.</p>
</div>

<section id="entering-the-development-environment">
<h3>Entering the Development Environment<a class="headerlink" href="#entering-the-development-environment" title="Permalink to this headline">¶</a></h3>
<p>The first time you attempt to use the MiniAV development environment, the docker container will need to be built (the <code class="docutils literal notranslate"><span class="pre">av</span></code> package will do this for you). This may take upwards of 15 minutes, depending on the number of packages your control stack needs to install. After the initial build, you may never need to build the stack again (unless you need additional packages installed). To build the container the first time around, you can run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>av dev
</pre></div>
</div>
<p>This is equivalent to running the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>av dev --up --attach
</pre></div>
</div>
<p>And since the image has never been built, the <code class="docutils literal notranslate"><span class="pre">--up</span></code> argument will also build it. This is only the case if the image cannot be found, i.e. the first time you run <code class="docutils literal notranslate"><span class="pre">av</span> <span class="pre">dev</span></code>.</p>
<p>If you make changes to the workspace and need additional packages to be installed into the container, you can run the same command with the build flag:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>av dev --build
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is <em>not</em> equivalient to <code class="docutils literal notranslate"><span class="pre">av</span> <span class="pre">dev</span> <span class="pre">--up</span> <span class="pre">--attach</span> <span class="pre">--build</span></code>. <code class="docutils literal notranslate"><span class="pre">--up</span></code> and <code class="docutils literal notranslate"><span class="pre">--attach</span></code> are only added if no other arguments are provided</p>
</div>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the container is already running (i.e. <code class="docutils literal notranslate"><span class="pre">av</span> <span class="pre">dev</span> <span class="pre">--up</span></code> has already been called), the new built image will not be loaded automatically. You need to tear down the container by running <code class="docutils literal notranslate"><span class="pre">av</span> <span class="pre">dev</span> <span class="pre">--down</span></code> or <code class="docutils literal notranslate"><span class="pre">av</span> <span class="pre">dev</span> <span class="pre">-d</span></code> and then spin up the container again with <code class="docutils literal notranslate"><span class="pre">av</span> <span class="pre">dev</span> <span class="pre">--up</span></code></p>
</div>

<p>After you run <code class="docutils literal notranslate"><span class="pre">av</span> <span class="pre">dev</span></code>, you should see a shell prompt like the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ av dev
WARNING  <span class="p">|</span> logger.set_verbosity :: Verbosity has been <span class="nb">set</span> to WARNING
av-dev:~$
</pre></div>
</div>
</section>
<section id="developing-inside-the-container">
<h3>Developing Inside the Container<a class="headerlink" href="#developing-inside-the-container" title="Permalink to this headline">¶</a></h3>
<p>Once inside the container, if you type <code class="docutils literal notranslate"><span class="pre">ls</span></code>, you should see the <code class="docutils literal notranslate"><span class="pre">av</span></code> folder that is a mapped volumes from the host system. As mentioned before, any code you write should be done here or your changes will persist once the container is destroyed.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>To write more …</p>
</div>
</section>
</section>
<section id="support">
<h2>Support<a class="headerlink" href="#support" title="Permalink to this headline">¶</a></h2>
<p>Contact the <a class="reference external" href="mailto:negrut%40wisc.edu">Simulation Based Engineering Laboratory</a> for any questions or concerns regarding the contents of this repository.</p>
</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<p>Visit our website at <a class="reference external" href="https://sbel.wisc.edu">sbel.wisc.edu</a>!</p>
</section>
</section>

      </article>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../usage/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">API Reference</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Tutorials</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2022, Simulation Based Engineering Laboratory
            |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            |
            <a class="muted-link" href="../_sources/tutorials/using_the_development_environment.md.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Using the AV Development Environment</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#design-considerations">Design Considerations</a></li>
<li><a class="reference internal" href="#background">Background</a></li>
<li><a class="reference internal" href="#setup">Setup</a></li>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#entering-the-development-environment">Entering the Development Environment</a></li>
<li><a class="reference internal" href="#developing-inside-the-container">Developing Inside the Container</a></li>
</ul>
</li>
<li><a class="reference internal" href="#support">Support</a></li>
<li><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </main>
</div>
  </body>
</html>