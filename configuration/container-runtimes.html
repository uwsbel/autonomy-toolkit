<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Tutorials" href="../tutorials/index.html" /><link rel="prev" title="Environment Variables" href="environment-variables.html" />

    <link rel="shortcut icon" href="../_static/cropped-SBEL-32x32.png"/><!-- Generated with Sphinx 5.3.0 and Furo 2022.12.07 -->
        <title>Container Runtimes - Autonomous Vehicle Toolbox 1.0.14 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f0f0f0;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<div class="announcement">
  <aside class="announcement-content">
     
        <a style="text-decoration: none; color: white;" 
           href="https://sbel.wisc.edu">
           <img src="https://github.com/uwsbel/autonomy-toolkit/blob/main/docs/_static/cropped-SBEL-192x192.png?raw=true" 
                style="vertical-align: middle; display: inline; padding-right: 7.5px; height: 20px;"/>
           Checkout our website!
        </a>
     
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Autonomous Vehicle Toolbox 1.0.14 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/SBEL-light.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/SBEL-dark.png" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup.html">Setup</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Configuration</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="atk-configuration-file.html">ATK Configuration File</a></li>
<li class="toctree-l2"><a class="reference internal" href="variable-replacement.html">Variable Replacement</a></li>
<li class="toctree-l2"><a class="reference internal" href="environment-variables.html">Environment Variables</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Container Runtimes</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/using-the-development-environment/README.html">Using the ATK Development Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/autonomy-research-testbed/autonomy-research-testbed.html">Autonomy Research Testbed</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../usage/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../usage/cli.html">CLI Documentation</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../usage/api/autonomy_toolkit/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autonomy_toolkit</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../usage/api/autonomy_toolkit/containers/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autonomy_toolkit.containers</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../usage/api/autonomy_toolkit/containers/container_client/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autonomy_toolkit.containers.container_client</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../usage/api/autonomy_toolkit/containers/docker_client/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autonomy_toolkit.containers.docker_client</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../usage/api/autonomy_toolkit/containers/singularity_client/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autonomy_toolkit.containers.singularity_client</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../usage/api/autonomy_toolkit/ros/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autonomy_toolkit.ros</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../usage/api/autonomy_toolkit/ros/messages/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autonomy_toolkit.ros.messages</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../usage/api/autonomy_toolkit/utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autonomy_toolkit.utils</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../usage/api/autonomy_toolkit/utils/atk_config/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autonomy_toolkit.utils.atk_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../usage/api/autonomy_toolkit/utils/files/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autonomy_toolkit.utils.files</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../usage/api/autonomy_toolkit/utils/logger/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autonomy_toolkit.utils.logger</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../usage/api/autonomy_toolkit/utils/parsing/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autonomy_toolkit.utils.parsing</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../usage/api/autonomy_toolkit/utils/system/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autonomy_toolkit.utils.system</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../usage/api/autonomy_toolkit/db/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autonomy_toolkit.db</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/api/autonomy_toolkit/dev/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autonomy_toolkit.dev</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../usage/api/autonomy_toolkit/run/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">autonomy_toolkit.run</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">External Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/autonomy-toolkit/">PyPI</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/uwsbel/autonomy-toolkit">Github</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="container-runtimes">
<h1>Container Runtimes<a class="headerlink" href="#container-runtimes" title="Permalink to this heading">#</a></h1>
<p>ATK supports any container orchestration system; the <code class="docutils literal notranslate"><span class="pre">atk.yml</span></code> file follows Docker Compose standards, which is supported by <a class="reference external" href="https://github.com/containers/podman-compose">podman-compose</a>. Furthermore, some container orchestration projects (e.g. <a class="reference external" href="https://singularityhub.github.io/singularity-compose/#/">singularity-compose</a> has some minor changes which requires adjustments to the <code class="docutils literal notranslate"><span class="pre">atk.yml</span></code> file to support it. A mechanism for adjusting the <code class="docutils literal notranslate"><span class="pre">atk.yml</span></code> file for specific orchestration types is supported through ATK (see the <a class="reference external" href="https://projects.sbel.org/autonomy-toolkit/usage/api/autonomy_toolkit/containers/index.html">ATK docs</a> for examples).</p>
<section id="supported-runtimes">
<h2>Supported Runtimes<a class="headerlink" href="#supported-runtimes" title="Permalink to this heading">#</a></h2>
<p>To change the orchestration backend that is used by ATK, you need to adjust the <code class="docutils literal notranslate"><span class="pre">ATK_CONTAINER_RUNTIME</span></code> environment variable. See <a class="reference internal" href="environment-variables.html"><span class="doc std std-doc">environment variable</span></a> docs for more info.</p>
<section id="docker-compose">
<h3>Docker Compose<a class="headerlink" href="#docker-compose" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://docs.docker.com/compose/">Docker Compose</a> is the industry standard when it comes to container orchestration systems. This is used by default.</p>
</section>
<section id="singularity-compose">
<h3>Singularity Compose<a class="headerlink" href="#singularity-compose" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://singularityhub.github.io/singularity-compose/#/">Singularity Compose</a> is a tool in beta release that wraps <a class="reference external" href="https://sylabs.io/guides/3.5/user-guide/index.html">Singularity</a>. A singularity implementation is present in ATK because Docker has security issues that makes it not ideal for use on shared systems (see <a class="reference external" href="https://logrhythm.com/blog/how-to-mitigate-docker-security-risk/">here</a> for more information). Singularity provides a feature that leverages <code class="docutils literal notranslate"><span class="pre">fakeroot</span></code> to let users build and attach to containers on systems where it’s not typically possible to run container systems.</p>
<p>The system administrator for your shared computer may need to do the following to ensure singularity-compose works as expected:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://sylabs.io/guides/3.5/user-guide/cli/singularity_config_fakeroot.html">Add fakeroot support</a></p></li>
<li><p>Add your user to the network config</p>
<ul>
<li><p>This is only necessary if you don’t want to be root in the container and you’d like to allow port mapping between the container and host. If you don’t mind being root in the container, just use fakeroot.</p></li>
<li><p>i.e. <code class="docutils literal notranslate"><span class="pre">singularity</span> <span class="pre">global</span> <span class="pre">config</span> <span class="pre">--set</span> <span class="pre">&quot;allow</span> <span class="pre">net</span> <span class="pre">users&quot;</span> <span class="pre">&lt;USER&gt;</span></code></p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading">#</a></h2>
<p>There may be some configuration necessary to ensure different container systems function properly. Described here are a few mechanisms to support that.</p>
<section id="atk-container-runtime">
<h3><code class="docutils literal notranslate"><span class="pre">ATK_CONTAINER_RUNTIME</span></code><a class="headerlink" href="#atk-container-runtime" title="Permalink to this heading">#</a></h3>
<p>See <a class="reference internal" href="environment-variables.html"><span class="doc std std-doc">environment variable</span></a> docs for more information on how to properly set the container runtime.</p>
</section>
<section id="custom-cli-argments">
<h3><code class="docutils literal notranslate"><span class="pre">custom_cli_argments</span></code><a class="headerlink" href="#custom-cli-argments" title="Permalink to this heading">#</a></h3>
<p>Different container orchestration systems (i.e. <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">compose</span></code> or <code class="docutils literal notranslate"><span class="pre">singularity-compose</span></code>) may have different configuration standards, so <code class="docutils literal notranslate"><span class="pre">custom_cli_argments</span></code> may need to be used in conjunction with different container systems.</p>
<p>By default, whatever is present in the service’s <code class="docutils literal notranslate"><span class="pre">custom_cli_argments</span></code> field will be applied to the service configuration.</p>
<p>For example, if the following configuration includes this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">project</span><span class="p">:</span> <span class="n">test</span>
<span class="n">default_containers</span><span class="p">:</span>
	<span class="o">-</span> <span class="n">dev</span>
<span class="n">custom_cli_arguments</span><span class="p">:</span>
  <span class="n">gpus</span><span class="p">:</span>
    <span class="n">argparse</span><span class="p">:</span>
      <span class="n">action</span><span class="p">:</span> <span class="s1">&#39;store_true&#39;</span>
    <span class="nb">all</span><span class="p">:</span>
      <span class="n">runtime</span><span class="p">:</span> <span class="n">nvidia</span>
<span class="n">services</span><span class="p">:</span>
	<span class="n">dev</span><span class="p">:</span>
		<span class="n">some_configuration_stuff</span><span class="p">:</span> <span class="n">BLAH</span>
</pre></div>
</div>
<p>And a user calls <code class="docutils literal notranslate"><span class="pre">atk</span> <span class="pre">dev</span> <span class="pre">--services</span> <span class="pre">dev</span> <span class="pre">--custom-cli-args</span> <span class="pre">gpus</span></code>, the resulting configuration will look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">project</span><span class="p">:</span> <span class="n">test</span>
<span class="n">default_containers</span><span class="p">:</span>
	<span class="o">-</span> <span class="n">dev</span>
<span class="n">custom_cli_arguments</span><span class="p">:</span>
  <span class="n">gpus</span><span class="p">:</span>
    <span class="n">argparse</span><span class="p">:</span>
      <span class="n">action</span><span class="p">:</span> <span class="s1">&#39;store_true&#39;</span>
    <span class="nb">all</span><span class="p">:</span>
      <span class="n">runtime</span><span class="p">:</span> <span class="n">nvidia</span>
<span class="n">services</span><span class="p">:</span>
	<span class="n">dev</span><span class="p">:</span>
		<span class="n">some_configuration_stuff</span><span class="p">:</span> <span class="n">BLAH</span>
		<span class="n">runtime</span><span class="p">:</span> <span class="n">nvidia</span> <span class="c1"># NEW!!!</span>
</pre></div>
</div>
<p>However, for singularity, the flag instead should be <code class="docutils literal notranslate"><span class="pre">nv:</span> <span class="pre">true</span></code>. To support this, an optional nested field can be used in each service’s <code class="docutils literal notranslate"><span class="pre">custom_cli_arguments</span></code> configuration that matches the container runtime.</p>
<p>For instance, if we’d like to support both <code class="docutils literal notranslate"><span class="pre">nvidia:</span> <span class="pre">runtime</span></code> for Docker and <code class="docutils literal notranslate"><span class="pre">nv:</span> <span class="pre">true</span></code> for singularity, you can do the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">project</span><span class="p">:</span> <span class="n">test</span>
<span class="n">default_containers</span><span class="p">:</span>
	<span class="o">-</span> <span class="n">dev</span>
<span class="n">custom_cli_arguments</span><span class="p">:</span>
  <span class="n">gpus</span><span class="p">:</span>
    <span class="n">argparse</span><span class="p">:</span>
      <span class="n">action</span><span class="p">:</span> <span class="s1">&#39;store_true&#39;</span>
    <span class="nb">all</span><span class="p">:</span>
			<span class="n">docker</span><span class="p">:</span>
				<span class="n">runtime</span><span class="p">:</span> <span class="n">nvidia</span>
			<span class="n">singularity</span><span class="p">:</span>
				<span class="n">nv</span><span class="p">:</span> <span class="n">true</span>
<span class="n">services</span><span class="p">:</span>
	<span class="n">dev</span><span class="p">:</span>
		<span class="n">some_configuration_stuff</span><span class="p">:</span> <span class="n">BLAH</span>
</pre></div>
</div>
<p>This will then check at runtime if <code class="docutils literal notranslate"><span class="pre">ATK_CONTAINER_RUNTIME</span></code> matches the first level under the service name (i.e. <code class="docutils literal notranslate"><span class="pre">all</span></code> in this case), and only use that config if found.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../tutorials/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Tutorials</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="environment-variables.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Environment Variables</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Simulation Based Engineering Laboratory
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Container Runtimes</a><ul>
<li><a class="reference internal" href="#supported-runtimes">Supported Runtimes</a><ul>
<li><a class="reference internal" href="#docker-compose">Docker Compose</a></li>
<li><a class="reference internal" href="#singularity-compose">Singularity Compose</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuration">Configuration</a><ul>
<li><a class="reference internal" href="#atk-container-runtime"><code class="docutils literal notranslate"><span class="pre">ATK_CONTAINER_RUNTIME</span></code></a></li>
<li><a class="reference internal" href="#custom-cli-argments"><code class="docutils literal notranslate"><span class="pre">custom_cli_argments</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    </body>
</html>